(self["webpackChunkjingdong"]=self["webpackChunkjingdong"]||[]).push([[523],{220:function(t,c,s){s(7658);const e={match:/vue-cli-service lint/,description:"org.vue.eslint.tasks.lint.description",link:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-eslint#injected-commands",prompts:[{name:"noFix",type:"confirm",default:!1,description:"org.vue.eslint.tasks.lint.noFix"}],onBeforeRun:({answers:t,args:c})=>{t.noFix&&c.push("--no-fix")}};t.exports={task:e}},3229:function(t,c,s){"use strict";s.d(c,{r:function(){return a}});var e=s(65);const a=()=>{const t=(0,e.oR)(),{cartList:c}=t.state,s=(c,s,e,a)=>{t.commit("changeCartItemInfo",{shopId:c,productId:s,productInfo:e,num:a})},a=(c,s)=>{t.commit("changeShopName",{shopId:c,shopName:s})},n=(c,s)=>{t.commit("changeCartItemChecked",{shopId:c,productId:s})},o=c=>{t.commit("cleanCartProducts",{shopId:c})},i=(c,s)=>{t.commit("setCartItemChecked",{shopId:c,checked:s})};return{cartList:c,changeShopName:a,changeCartItemInfo:s,changeCartItemChecked:n,cleanCartProducts:o,setCartItemChecked:i}}},6538:function(t,c,s){"use strict";s.d(c,{Z:function(){return g}});var e=s(3396),a=s(7139);const n={class:"shop"},o=["src"],i={class:"shop__content__title"},r={class:"shop__content__tags"},_={class:"shop__content__tag"},l={class:"shop__content__tag"},d={class:"shop__content__tag"},u={class:"shop__content__highlight"};function p(t,c,s,p,m,h){return(0,e.wg)(),(0,e.iD)("div",n,[(0,e._)("img",{class:"shop__img",src:s.item.imgUrl,alt:""},null,8,o),(0,e._)("div",{class:(0,a.C_)(["shop__content",{"shop__content--bordered":!s.hideBorder}])},[(0,e._)("div",i,(0,a.zw)(s.item.name),1),(0,e._)("div",r,[(0,e._)("span",_,"月售"+(0,a.zw)(s.item.sales),1),(0,e._)("span",l,"起送¥"+(0,a.zw)(s.item.expressLimit),1),(0,e._)("span",d,"基础运费¥"+(0,a.zw)(s.item.expressPrice),1)]),(0,e._)("div",u,(0,a.zw)(s.item.slogan),1)],2)])}var m={name:"ShopInfo",props:["item","hideBorder"]},h=s(89);const k=(0,h.Z)(m,[["render",p],["__scopeId","data-v-820a85e4"]]);var g=k},5538:function(t,c,s){"use strict";s.r(c),s.d(c,{default:function(){return ft}});var e=s(3396),a=s(9242);const n=t=>((0,e.dD)("data-v-2d87b51a"),t=t(),(0,e.Cn)(),t),o={class:"wrapper"},i={class:"top"},r={class:"top__back"},_=n((()=>(0,e._)("div",{class:"search"},[(0,e._)("span",{class:"iconfont"},""),(0,e._)("input",{type:"text",class:"search__input",placeholder:"请输入商品名称搜索"})],-1)));function l(t,c,s,n,l,d){const u=(0,e.up)("ShopInfo"),p=(0,e.up)("Content"),m=(0,e.up)("Cart"),h=(0,e.up)("Toast");return(0,e.wg)(),(0,e.iD)(e.HY,null,[(0,e._)("div",o,[(0,e._)("div",i,[(0,e._)("div",r,[(0,e._)("span",{class:"iconfont",onClick:c[0]||(c[0]=(...t)=>n.handleBackClick&&n.handleBackClick(...t))},"")]),_]),(0,e.wy)((0,e.Wm)(u,{item:t.item,"hide-border":!0},null,8,["item"]),[[a.F8,t.item.imgUrl]]),(0,e.Wm)(p,{shopName:t.item.name},null,8,["shopName"]),(0,e.Wm)(m)]),n.toastInfo.show?((0,e.wg)(),(0,e.j4)(h,{key:0,message:n.toastInfo.message},null,8,["message"])):(0,e.kq)("",!0)],64)}var d=s(4870),u=s(2483),p=s(6391),m=s(6538),h=s(7139);const k=t=>((0,e.dD)("data-v-b2848de4"),t=t(),(0,e.Cn)(),t),g={class:"content"},C={class:"category"},v=["onClick"],I={class:"product"},w=["src"],f={class:"product__item__detail"},b={class:"product__item__title"},y={class:"product__item__sales"},D={class:"product__item__price"},z=k((()=>(0,e._)("span",{class:"product__item__yen"},"¥",-1))),L={class:"product__item__now"},P={class:"product__item__origin"},H={class:"product__number"},T=["onClick"],q={key:1,class:"product__number__count"},j=["onClick"];function x(t,c,s,a,n,o){const i=(0,e.up)("Toast");return(0,e.wg)(),(0,e.iD)(e.HY,null,[(0,e._)("div",g,[(0,e._)("div",C,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(a.categories,((t,c)=>((0,e.wg)(),(0,e.iD)("div",{class:(0,h.C_)(["category__item",{"category__item--active":a.currentTab===t.tab}]),key:c,onClick:c=>a.currentTab=t.tab},(0,h.zw)(t.name),11,v)))),128))]),(0,e._)("div",I,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(t.contentList,(c=>((0,e.wg)(),(0,e.iD)("div",{class:"product__item",key:c._id},[(0,e._)("img",{class:"product__item__img",src:c.imgUrl,alt:""},null,8,w),(0,e._)("div",f,[(0,e._)("div",b,(0,h.zw)(c.name),1),(0,e._)("div",y,"月售"+(0,h.zw)(c.sales)+"件",1),(0,e._)("div",D,[z,(0,e._)("span",L,(0,h.zw)(c.price),1),(0,e._)("span",P,"¥"+(0,h.zw)(c.oldPrice),1)])]),(0,e._)("div",H,[t.getProductCartCount(a.shopId,c._id)>0?((0,e.wg)(),(0,e.iD)("span",{key:0,class:"iconfont product__number__minus",onClick:s=>t.changeCartItemInfo(a.shopId,c._id,c,-1)},"",8,T)):(0,e.kq)("",!0),t.getProductCartCount(a.shopId,c._id)>0?((0,e.wg)(),(0,e.iD)("span",q,(0,h.zw)(t.getProductCartCount(a.shopId,c._id)),1)):(0,e.kq)("",!0),(0,e._)("span",{class:"iconfont product__number__plus",onClick:s=>t.changeCartItemInfo(a.shopId,c._id,c,1)},"",8,j)])])))),128))])]),a.toastInfo.show?((0,e.wg)(),(0,e.j4)(i,{key:0,message:a.toastInfo.message},null,8,["message"])):(0,e.kq)("",!0)],64)}s(7658);var N=s(3229),S=s(1090);const Y=[{name:"全部商品",tab:"all"},{name:"秒杀",tab:"seckill"},{name:"新鲜水果",tab:"fruit"},{name:"休闲食品",tab:"snacks"},{name:"时令蔬菜",tab:"vegetable"},{name:"肉蛋家禽",tab:"meat"}],B=(t,c)=>{const{cartList:s,changeCartItemInfo:a,changeShopName:n}=(0,N.r)();(0,e.YP)((()=>c.shopName),(()=>{n(t,c.shopName)}));const o=(t,c)=>s[t]?.productList?.[c]?.count||0;return{changeCartItemInfo:a,getProductCartCount:o}};var Z={name:"Content",components:{Toast:S.Z},props:["shopName"],setup(t){const c=(0,d.iH)(Y[0].tab),s=(0,d.qj)({contentList:[]}),{toastInfo:a,showToast:n}=(0,S.S)(),o=(0,u.yj)(),i=o.params.id,r=async t=>{try{const c=await(0,p.U)(`/api/shop/${i}s/products`,{tab:t});if(0!==c.errno)return n(c.desc);s.contentList.push(...c.data)}catch(c){n(c.message)}};return r(c.value),(0,e.YP)(c,(()=>{r(c.value)})),{categories:Y,toastInfo:a,currentTab:c,...(0,d.BK)(s),shopId:i,...B(i,t)}}},U=s(89);const F=(0,U.Z)(Z,[["render",x],["__scopeId","data-v-b2848de4"]]);var K=F;const M=t=>((0,e.dD)("data-v-23f6196c"),t=t(),(0,e.Cn)(),t),W={class:"cart"},$={key:0,class:"product"},R={class:"product__header"},A=["innerHTML"],E=M((()=>(0,e._)("span",null,"全选",-1))),G=M((()=>(0,e._)("div",{class:"product__header__blank"},null,-1))),J={key:0,class:"product__item"},O=["innerHTML","onClick"],Q=["src"],V={class:"product__item__detail"},X={class:"product__item__title"},tt={class:"product__item__price"},ct=M((()=>(0,e._)("span",{class:"product__item__yen"},"¥",-1))),st={class:"product__item__now"},et={class:"product__item__origin"},at={class:"product__number"},nt=["onClick"],ot={key:1,class:"product__number__count"},it=["onClick"],rt={class:"check"},_t=M((()=>(0,e._)("img",{class:"check__icon__img",src:"http://www.dell-lee.com/imgs/vue3/basket.png",alt:""},null,-1))),lt={key:0,class:"check__icon__tag"},dt={class:"check__info"},ut={class:"check__info__price"},pt=M((()=>(0,e._)("div",{class:"check__btn"}," 去结算 ",-1)));function mt(t,c,s,a,n,o){const i=(0,e.up)("router-link");return(0,e.wg)(),(0,e.iD)(e.HY,null,[t.showChart?((0,e.wg)(),(0,e.iD)("div",{key:0,class:"cart__mask",onClick:c[0]||(c[0]=c=>t.showChart=!t.showChart)})):(0,e.kq)("",!0),(0,e._)("div",W,[t.showChart?((0,e.wg)(),(0,e.iD)("div",$,[(0,e._)("div",R,[(0,e._)("div",{class:"product__header__all",onClick:c[1]||(c[1]=c=>t.setCartItemChecked(t.shopId,t.calculations.allChecked))},[(0,e._)("span",{class:"iconfont",innerHTML:t.calculations.allChecked?"":""},null,8,A),E]),G,(0,e._)("div",{class:"product__header__clear",onClick:c[2]||(c[2]=c=>{t.cleanCartProducts(t.shopId),t.showChart=!1})},"清空购物车")]),((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(t.calculations.productList,(c=>((0,e.wg)(),(0,e.iD)(e.HY,{key:c._id},[c.count>0?((0,e.wg)(),(0,e.iD)("div",J,[(0,e._)("span",{class:"product__item__checked iconfont",innerHTML:c.check?"":"",onClick:s=>t.changeCartItemChecked(t.shopId,c._id)},null,8,O),(0,e._)("img",{class:"product__item__img",src:c.imgUrl,alt:""},null,8,Q),(0,e._)("div",V,[(0,e._)("div",X,(0,h.zw)(c.name),1),(0,e._)("div",tt,[ct,(0,e._)("span",st,(0,h.zw)(c.price),1),(0,e._)("span",et,"¥"+(0,h.zw)(c.oldPrice),1)])]),(0,e._)("div",at,[c.count>0?((0,e.wg)(),(0,e.iD)("span",{key:0,class:"iconfont product__number__minus",onClick:s=>t.changeCartItemInfo(t.shopId,c._id,c,-1)},"",8,nt)):(0,e.kq)("",!0),c.count>0?((0,e.wg)(),(0,e.iD)("span",ot,(0,h.zw)(c.count||0),1)):(0,e.kq)("",!0),(0,e._)("span",{class:"iconfont product__number__plus",onClick:s=>t.changeCartItemInfo(t.shopId,c._id,c,1)},"",8,it)])])):(0,e.kq)("",!0)],64)))),128))])):(0,e.kq)("",!0),(0,e._)("div",rt,[(0,e._)("div",{class:"check__icon",onClick:c[3]||(c[3]=c=>t.calculations.sum>0&&(t.showChart=!t.showChart))},[_t,t.calculations.total>0?((0,e.wg)(),(0,e.iD)("div",lt,(0,h.zw)(t.calculations.total),1)):(0,e.kq)("",!0)]),(0,e._)("div",dt,[(0,e.Uk)(" 总计："),(0,e._)("span",ut,"¥"+(0,h.zw)(t.calculations.price),1)]),(0,e.Wm)(i,{to:t.calculations.total&&`/orderConfirmation/${t.shopId}`},{default:(0,e.w5)((()=>[pt])),_:1},8,["to"])])])],64)}var ht=s(220);const kt=()=>{const t=(0,u.yj)(),c=t.params.id,s=(0,d.iH)(!1),{cartList:a,changeCartItemInfo:n,changeCartItemChecked:o,cleanCartProducts:i,setCartItemChecked:r}=(0,N.r)(),_=(0,e.Fl)((()=>{const t=a[c]?.productList;let e=0,n=0,o=0,i=!0;for(const c in t){const s=t[c];e+=s.count,s.check&&(n+=s.count),s.check&&(o+=s.price*s.count),!s.check&&(i=s.check)}return!e&&(s.value=!1),{productList:t,sum:e,total:n,price:o.toFixed(2),allChecked:i}}));return{showChart:s,calculations:_,shopId:c,changeCartItemInfo:n,changeCartItemChecked:o,cleanCartProducts:i,setCartItemChecked:r}};var gt={name:"Cart",computed:{task(){return ht.task}},setup(){return{...kt()}}};const Ct=(0,U.Z)(gt,[["render",mt],["__scopeId","data-v-23f6196c"]]);var vt=Ct,It={name:"Shop",components:{ShopInfo:m.Z,Content:K,Cart:vt,Toast:S.Z},setup(){const t=(0,u.tv)(),c=(0,u.yj)(),s=(0,d.qj)({item:{}}),{toastInfo:e,showToast:a}=(0,S.S)(),n=async()=>{try{const t=await(0,p.U)(`/api/shop/${c.params.id}`);if(0!==t?.errno)return a(t.desc);s.item=t.data}catch(t){a(t.message)}};n();const o=()=>{t.back()};return{...(0,d.BK)(s),toastInfo:e,handleBackClick:o}}};const wt=(0,U.Z)(It,[["render",l],["__scopeId","data-v-2d87b51a"]]);var ft=wt}}]);
//# sourceMappingURL=shop.0b639596.js.map