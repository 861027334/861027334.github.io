"use strict";(self["webpackChunkjingdong"]=self["webpackChunkjingdong"]||[]).push([[523],{3229:function(t,c,s){s.d(c,{_G:function(){return o},aH:function(){return n},dO:function(){return r},jw:function(){return _},rs:function(){return i}});var a=s(65),e=s(2483);const n=()=>(0,e.yj)().params.id,o=()=>(0,a.oR)().state.cartList,r=()=>o()?.[n()]?.shopName,_=()=>o()?.[n()]?.productList,i=()=>{const t=(0,a.oR)(),c=(c,s,a,e)=>{t.commit("changeCartItemInfo",{shopId:c,productId:s,productInfo:a,num:e})},s=(c,s)=>{t.commit("changeShopName",{shopId:c,shopName:s})},e=(c,s)=>{t.commit("changeCartItemChecked",{shopId:c,productId:s})},n=c=>{t.commit("cleanCartProducts",{shopId:c})},o=(c,s)=>{t.commit("setCartItemChecked",{shopId:c,checked:s})};return{changeShopName:s,changeCartItemInfo:c,changeCartItemChecked:e,cleanCartProducts:n,setCartItemChecked:o}}},6538:function(t,c,s){s.d(c,{Z:function(){return k}});var a=s(3396),e=s(7139);const n={class:"shop"},o=["src"],r={class:"shop__content__title"},_={class:"shop__content__tags"},i={class:"shop__content__tag"},l={class:"shop__content__tag"},d={class:"shop__content__tag"},u={class:"shop__content__highlight"};function p(t,c,s,p,m,h){return(0,a.wg)(),(0,a.iD)("div",n,[(0,a._)("img",{class:"shop__img",src:s.item.imgUrl,alt:""},null,8,o),(0,a._)("div",{class:(0,e.C_)(["shop__content",{"shop__content--bordered":!s.hideBorder}])},[(0,a._)("div",r,(0,e.zw)(s.item.name),1),(0,a._)("div",_,[(0,a._)("span",i,"月售"+(0,e.zw)(s.item.sales),1),(0,a._)("span",l,"起送¥"+(0,e.zw)(s.item.expressLimit),1),(0,a._)("span",d,"基础运费¥"+(0,e.zw)(s.item.expressPrice),1)]),(0,a._)("div",u,(0,e.zw)(s.item.slogan),1)],2)])}var m={name:"ShopInfo",props:["item","hideBorder"]},h=s(89);const C=(0,h.Z)(m,[["render",p],["__scopeId","data-v-820a85e4"]]);var k=C},753:function(t,c,s){s.r(c),s.d(c,{default:function(){return wt}});var a=s(3396),e=s(9242);const n=t=>((0,a.dD)("data-v-07f436d4"),t=t(),(0,a.Cn)(),t),o={class:"wrapper"},r={class:"top"},_={class:"top__back"},i=n((()=>(0,a._)("div",{class:"search"},[(0,a._)("span",{class:"iconfont"},""),(0,a._)("input",{type:"text",class:"search__input",placeholder:"请输入商品名称搜索"})],-1)));function l(t,c,s,n,l,d){const u=(0,a.up)("ShopInfo"),p=(0,a.up)("Content"),m=(0,a.up)("Cart"),h=(0,a.up)("Toast");return(0,a.wg)(),(0,a.iD)("div",o,[(0,a._)("div",r,[(0,a._)("div",_,[(0,a._)("span",{class:"iconfont",onClick:c[0]||(c[0]=(...t)=>n.handleBackClick&&n.handleBackClick(...t))},"")]),i]),(0,a.wy)((0,a.Wm)(u,{item:t.item,"hide-border":!0},null,8,["item"]),[[e.F8,t.item.imgUrl]]),(0,a.Wm)(p,{shopName:t.item.name},null,8,["shopName"]),(0,a.Wm)(m),n.toastInfo.show?((0,a.wg)(),(0,a.j4)(h,{key:0,message:n.toastInfo.message},null,8,["message"])):(0,a.kq)("",!0)])}var d=s(4870),u=s(2483),p=s(6391),m=s(6538),h=s(7139);const C=t=>((0,a.dD)("data-v-6c88bf04"),t=t(),(0,a.Cn)(),t),k={class:"content"},g={class:"category"},I=["onClick"],v={class:"product"},w=["src"],f={class:"product__item__detail"},b={class:"product__item__title"},y={class:"product__item__sales"},D={class:"product__item__price"},z=C((()=>(0,a._)("span",{class:"product__item__yen"},"¥",-1))),L={class:"product__item__now"},P={class:"product__item__origin"},H={class:"product__number"},T=["onClick"],q={key:1,class:"product__number__count"},j=["onClick"];function N(t,c,s,e,n,o){const r=(0,a.up)("Toast");return(0,a.wg)(),(0,a.iD)("div",k,[(0,a._)("div",g,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.categories,((t,c)=>((0,a.wg)(),(0,a.iD)("div",{class:(0,h.C_)(["category__item",{"category__item--active":e.currentTab===t.tab}]),key:c,onClick:c=>e.currentTab=t.tab},(0,h.zw)(t.name),11,I)))),128))]),(0,a._)("div",v,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.contentList,(c=>((0,a.wg)(),(0,a.iD)("div",{class:"product__item",key:c._id},[(0,a._)("img",{class:"product__item__img",src:c.imgUrl,alt:""},null,8,w),(0,a._)("div",f,[(0,a._)("div",b,(0,h.zw)(c.name),1),(0,a._)("div",y,"月售"+(0,h.zw)(c.sales)+"件",1),(0,a._)("div",D,[z,(0,a._)("span",L,(0,h.zw)(c.price),1),(0,a._)("span",P,"¥"+(0,h.zw)(c.oldPrice),1)])]),(0,a._)("div",H,[t.getProductCartCount(e.shopId,c._id)>0?((0,a.wg)(),(0,a.iD)("span",{key:0,class:"iconfont product__number__minus",onClick:s=>t.changeCartItemInfo(e.shopId,c._id,c,-1)},"",8,T)):(0,a.kq)("",!0),t.getProductCartCount(e.shopId,c._id)>0?((0,a.wg)(),(0,a.iD)("span",q,(0,h.zw)(t.getProductCartCount(e.shopId,c._id)),1)):(0,a.kq)("",!0),(0,a._)("span",{class:"iconfont product__number__plus",onClick:s=>t.changeCartItemInfo(e.shopId,c._id,c,1)},"",8,j)])])))),128))]),e.toastInfo.show?((0,a.wg)(),(0,a.j4)(r,{key:0,message:e.toastInfo.message},null,8,["message"])):(0,a.kq)("",!0)])}s(7658);var S=s(3229),Z=s(1090);const B=[{name:"全部商品",tab:"all"},{name:"秒杀",tab:"seckill"},{name:"新鲜水果",tab:"fruit"},{name:"休闲食品",tab:"snacks"},{name:"时令蔬菜",tab:"vegetable"},{name:"肉蛋家禽",tab:"meat"}],U=(t,c)=>{const{changeCartItemInfo:s,changeShopName:e}=(0,S.rs)(),n=(0,S._G)(),o=(t,c)=>n[t]?.productList?.[c]?.count||0;return(0,a.YP)((()=>c.shopName),(()=>{e(t,c.shopName)})),{cartList:n,changeCartItemInfo:s,getProductCartCount:o}};var Y={name:"Content",components:{Toast:Z.Z},props:["shopName"],setup(t){const c=(0,S.aH)(),s=(0,d.iH)(B[0].tab),e=(0,d.qj)({contentList:[]}),{toastInfo:n,showToast:o}=(0,Z.S)(),r=async t=>{try{const s=await(0,p.U)(`/api/shop/${c}s/products`,{tab:t});if(0!==s.errno)return o(s.desc);e.contentList.push(...s.data)}catch(s){o(s.message)}};return r(s.value),(0,a.YP)(s,(()=>{r(s.value)})),{categories:B,toastInfo:n,currentTab:s,...(0,d.BK)(e),shopId:c,...U(c,t)}}},K=s(89);const x=(0,K.Z)(Y,[["render",N],["__scopeId","data-v-6c88bf04"]]);var M=x,F=s.p+"img/basket.929e6ea7.svg";const W=t=>((0,a.dD)("data-v-08961c5b"),t=t(),(0,a.Cn)(),t),$={class:"cart"},G={key:0,class:"product"},R={class:"product__header"},O=["innerHTML"],A=W((()=>(0,a._)("span",null,"全选",-1))),E=W((()=>(0,a._)("div",{class:"product__header__blank"},null,-1))),J=["innerHTML","onClick"],Q=["src"],V={class:"product__item__detail"},X={class:"product__item__title"},tt={class:"product__item__price"},ct=W((()=>(0,a._)("span",{class:"product__item__yen"},"¥",-1))),st={class:"product__item__now"},at={class:"product__item__origin"},et={class:"product__number"},nt=["onClick"],ot={key:1,class:"product__number__count"},rt=["onClick"],_t={class:"check"},it=W((()=>(0,a._)("img",{class:"check__icon__img",src:F,alt:""},null,-1))),lt={key:0,class:"check__icon__tag"},dt={class:"check__info"},ut={class:"check__info__price"},pt=W((()=>(0,a._)("div",{class:"check__btn"}," 去结算 ",-1)));function mt(t,c,s,e,n,o){const r=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)(a.HY,null,[t.showChart?((0,a.wg)(),(0,a.iD)("div",{key:0,class:"cart__mask",onClick:c[0]||(c[0]=c=>t.showChart=!t.showChart)})):(0,a.kq)("",!0),(0,a._)("div",$,[t.showChart?((0,a.wg)(),(0,a.iD)("div",G,[(0,a._)("div",R,[(0,a._)("div",{class:"product__header__all",onClick:c[1]||(c[1]=c=>t.setCartItemChecked(t.shopId,t.calculations.allChecked))},[(0,a._)("span",{class:"iconfont",innerHTML:t.calculations.allChecked?"":""},null,8,O),A]),E,(0,a._)("div",{class:"product__header__clear",onClick:c[2]||(c[2]=c=>{t.cleanCartProducts(t.shopId),t.showChart=!1})},"清空购物车")]),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.calculations.productList,(c=>((0,a.wg)(),(0,a.iD)("div",{key:c._id,class:"product__item"},[(0,a._)("span",{class:"product__item__checked iconfont",innerHTML:c.check?"":"",onClick:s=>t.changeCartItemChecked(t.shopId,c._id)},null,8,J),(0,a._)("img",{class:"product__item__img",src:c.imgUrl,alt:""},null,8,Q),(0,a._)("div",V,[(0,a._)("div",X,(0,h.zw)(c.name),1),(0,a._)("div",tt,[ct,(0,a._)("span",st,(0,h.zw)(c.price),1),(0,a._)("span",at,"¥"+(0,h.zw)(c.oldPrice),1)])]),(0,a._)("div",et,[c.count?((0,a.wg)(),(0,a.iD)("span",{key:0,class:"iconfont product__number__minus",onClick:s=>t.changeCartItemInfo(t.shopId,c._id,c,-1)},"",8,nt)):(0,a.kq)("",!0),c.count>0?((0,a.wg)(),(0,a.iD)("span",ot,(0,h.zw)(c.count||0),1)):(0,a.kq)("",!0),(0,a._)("span",{class:"iconfont product__number__plus",onClick:s=>t.changeCartItemInfo(t.shopId,c._id,c,1)},"",8,rt)])])))),128))])):(0,a.kq)("",!0),(0,a._)("div",_t,[(0,a._)("div",{class:"check__icon",onClick:c[3]||(c[3]=c=>t.calculations.sum>0&&(t.showChart=!t.showChart))},[it,t.calculations.total>0?((0,a.wg)(),(0,a.iD)("div",lt,(0,h.zw)(t.calculations.total),1)):(0,a.kq)("",!0)]),(0,a._)("div",dt,[(0,a.Uk)(" 总计："),(0,a._)("span",ut,"¥"+(0,h.zw)(t.calculations.price),1)]),t.calculations.total?((0,a.wg)(),(0,a.j4)(r,{key:0,to:`/orderConfirmation/${t.shopId}`},{default:(0,a.w5)((()=>[pt])),_:1},8,["to"])):(0,a.kq)("",!0)])])],64)}const ht=()=>{const t=(0,S.aH)(),c=(0,d.iH)(!1),s=(0,a.Fl)((()=>{const t=(0,S.jw)();let s=0,a=0,e=0,n=!0;for(const c in t){const o=t[c];s+=o.count,o.check&&(a+=o.count),o.check&&(e+=o.price*o.count),!o.check&&(n=o.check)}return!s&&(c.value=!1),{productList:t,sum:s,total:a,price:e.toFixed(2),allChecked:n}})),{changeCartItemInfo:e,changeCartItemChecked:n,cleanCartProducts:o,setCartItemChecked:r}=(0,S.rs)();return{shopId:t,showChart:c,calculations:s,changeCartItemInfo:e,changeCartItemChecked:n,cleanCartProducts:o,setCartItemChecked:r}};var Ct={name:"Cart",setup(){return{...ht()}}};const kt=(0,K.Z)(Ct,[["render",mt],["__scopeId","data-v-08961c5b"]]);var gt=kt,It={name:"Shop",components:{ShopInfo:m.Z,Content:M,Cart:gt,Toast:Z.Z},setup(){const t=(0,u.tv)(),c=(0,u.yj)(),s=(0,d.qj)({item:{}}),{toastInfo:a,showToast:e}=(0,Z.S)(),n=async()=>{try{const t=await(0,p.U)(`/api/shop/${c.params.id}`);if(0!==t?.errno)return e(t.desc);s.item=t.data}catch(t){e(t.message)}};n();const o=()=>{t.back()};return{...(0,d.BK)(s),toastInfo:a,handleBackClick:o}}};const vt=(0,K.Z)(It,[["render",l],["__scopeId","data-v-07f436d4"]]);var wt=vt}}]);
//# sourceMappingURL=shop.edcaadac.js.map