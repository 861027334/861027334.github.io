(self["webpackChunkjingdong"]=self["webpackChunkjingdong"]||[]).push([[523],{220:function(t,e,s){s(7658);const c={match:/vue-cli-service lint/,description:"org.vue.eslint.tasks.lint.description",link:"https://github.com/vuejs/vue-cli/tree/dev/packages/%40vue/cli-plugin-eslint#injected-commands",prompts:[{name:"noFix",type:"confirm",default:!1,description:"org.vue.eslint.tasks.lint.noFix"}],onBeforeRun:({answers:t,args:e})=>{t.noFix&&e.push("--no-fix")}};t.exports={task:c}},7420:function(t,e,s){"use strict";s.d(e,{Z:function(){return g}});var c=s(3396),a=s(7139);const n={class:"shop"},o=["src"],i={class:"shop__content__title"},r={class:"shop__content__tags"},_={class:"shop__content__tag"},l={class:"shop__content__tag"},d={class:"shop__content__tag"},u={class:"shop__content__highlight"};function p(t,e,s,p,m,h){return(0,c.wg)(),(0,c.iD)("div",n,[(0,c._)("img",{class:"shop__img",src:s.item.imgUrl,alt:""},null,8,o),(0,c._)("div",{class:(0,a.C_)(["shop__content",{"shop__content--bordered":!s.hideBorder}])},[(0,c._)("div",i,(0,a.zw)(s.item.name),1),(0,c._)("div",r,[(0,c._)("span",_,"月售"+(0,a.zw)(s.item.sales),1),(0,c._)("span",l,"起送¥"+(0,a.zw)(s.item.expressLimit),1),(0,c._)("span",d,"基础运费¥"+(0,a.zw)(s.item.expressPrice),1)]),(0,c._)("div",u,(0,a.zw)(s.item.slogan),1)],2)])}var m={name:"ShopInfo",props:["item","hideBorder"]},h=s(89);const k=(0,h.Z)(m,[["render",p],["__scopeId","data-v-532fc664"]]);var g=k},7218:function(t,e,s){"use strict";s.r(e),s.d(e,{default:function(){return bt}});var c=s(3396),a=s(9242);const n=t=>((0,c.dD)("data-v-2d87b51a"),t=t(),(0,c.Cn)(),t),o={class:"wrapper"},i={class:"top"},r={class:"top__back"},_=n((()=>(0,c._)("div",{class:"search"},[(0,c._)("span",{class:"iconfont"},""),(0,c._)("input",{type:"text",class:"search__input",placeholder:"请输入商品名称搜索"})],-1)));function l(t,e,s,n,l,d){const u=(0,c.up)("ShopInfo"),p=(0,c.up)("Content"),m=(0,c.up)("Cart"),h=(0,c.up)("Toast");return(0,c.wg)(),(0,c.iD)(c.HY,null,[(0,c._)("div",o,[(0,c._)("div",i,[(0,c._)("div",r,[(0,c._)("span",{class:"iconfont",onClick:e[0]||(e[0]=(...t)=>n.handleBackClick&&n.handleBackClick(...t))},"")]),_]),(0,c.wy)((0,c.Wm)(u,{item:t.item,"hide-border":!0},null,8,["item"]),[[a.F8,t.item.imgUrl]]),(0,c.Wm)(p,{shopName:t.item.name},null,8,["shopName"]),(0,c.Wm)(m)]),n.toastInfo.show?((0,c.wg)(),(0,c.j4)(h,{key:0,message:n.toastInfo.message},null,8,["message"])):(0,c.kq)("",!0)],64)}var d=s(4870),u=s(2483),p=s(6391),m=s(7420),h=s(7139);const k=t=>((0,c.dD)("data-v-48ed860d"),t=t(),(0,c.Cn)(),t),g={class:"content"},C={class:"category"},v=["onClick"],I={class:"product"},w=["src"],f={class:"product__item__detail"},b={class:"product__item__title"},y={class:"product__item__sales"},D={class:"product__item__price"},z=k((()=>(0,c._)("span",{class:"product__item__yen"},"¥",-1))),L={class:"product__item__now"},P={class:"product__item__origin"},H={class:"product__number"},T=["onClick"],q={key:1,class:"product__number__count"},j=["onClick"];function x(t,e,s,a,n,o){const i=(0,c.up)("Toast");return(0,c.wg)(),(0,c.iD)(c.HY,null,[(0,c._)("div",g,[(0,c._)("div",C,[((0,c.wg)(!0),(0,c.iD)(c.HY,null,(0,c.Ko)(a.categories,((t,e)=>((0,c.wg)(),(0,c.iD)("div",{class:(0,h.C_)(["category__item",{"category__item--active":a.currentTab===t.tab}]),key:e,onClick:e=>a.currentTab=t.tab},(0,h.zw)(t.name),11,v)))),128))]),(0,c._)("div",I,[((0,c.wg)(!0),(0,c.iD)(c.HY,null,(0,c.Ko)(t.contentList,(e=>((0,c.wg)(),(0,c.iD)("div",{class:"product__item",key:e._id},[(0,c._)("img",{class:"product__item__img",src:e.imgUrl,alt:""},null,8,w),(0,c._)("div",f,[(0,c._)("div",b,(0,h.zw)(e.name),1),(0,c._)("div",y,"月售"+(0,h.zw)(e.sales)+"件",1),(0,c._)("div",D,[z,(0,c._)("span",L,(0,h.zw)(e.price),1),(0,c._)("span",P,"¥"+(0,h.zw)(e.oldPrice),1)])]),(0,c._)("div",H,[t.getProductCartCount(a.shopId,e._id)>0?((0,c.wg)(),(0,c.iD)("span",{key:0,class:"iconfont product__number__minus",onClick:s=>t.changeCartItemInfo(a.shopId,e._id,e,-1)},"",8,T)):(0,c.kq)("",!0),t.getProductCartCount(a.shopId,e._id)>0?((0,c.wg)(),(0,c.iD)("span",q,(0,h.zw)(t.getProductCartCount(a.shopId,e._id)),1)):(0,c.kq)("",!0),(0,c._)("span",{class:"iconfont product__number__plus",onClick:s=>t.changeCartItemInfo(a.shopId,e._id,e,1)},"",8,j)])])))),128))])]),a.toastInfo.show?((0,c.wg)(),(0,c.j4)(i,{key:0,message:a.toastInfo.message},null,8,["message"])):(0,c.kq)("",!0)],64)}s(7658);var N=s(65);const S=()=>{const t=(0,N.oR)(),{cartList:e}=t.state,s=(e,s,c,a)=>{t.commit("changeCartItemInfo",{shopId:e,productId:s,productInfo:c,num:a})},c=(e,s)=>{t.commit("changeShopName",{shopId:e,shopName:s})},a=(e,s)=>{t.commit("changeCartItemChecked",{shopId:e,productId:s})},n=e=>{t.commit("cleanCartProducts",{shopId:e})},o=(e,s)=>{t.commit("setCartItemChecked",{shopId:e,checked:s})};return{cartList:e,changeShopName:c,changeCartItemInfo:s,changeCartItemChecked:a,cleanCartProducts:n,setCartItemChecked:o}};var Y=s(1090);const B=[{name:"全部商品",tab:"all"},{name:"秒杀",tab:"seckill"},{name:"新鲜水果",tab:"fruit"},{name:"休闲食品",tab:"snacks"},{name:"时令蔬菜",tab:"vegetable"},{name:"肉蛋家禽",tab:"meat"}],Z=(t,e)=>{const{cartList:s,changeCartItemInfo:a,changeShopName:n}=S();(0,c.YP)((()=>e.shopName),(()=>{n(t,e.shopName)}));const o=(t,e)=>s[t]?.productList?.[e]?.count||0;return{changeCartItemInfo:a,getProductCartCount:o}};var U={name:"Content",components:{Toast:Y.Z},props:["shopName"],setup(t){const e=(0,d.iH)(B[0].tab),s=(0,d.qj)({contentList:[]}),{toastInfo:a,showToast:n}=(0,Y.S)(),o=(0,u.yj)(),i=o.params.id,r=async t=>{try{const e=await(0,p.U)(`/api/shop/${i}s/products`,{tab:t});if(0!==e.errno)return n(e.desc);s.contentList.push(...e.data)}catch(e){n(e.message)}};return r(e.value),(0,c.YP)(e,(()=>{r(e.value)})),{categories:B,toastInfo:a,currentTab:e,...(0,d.BK)(s),shopId:i,...Z(i,t)}}},F=s(89);const K=(0,F.Z)(U,[["render",x],["__scopeId","data-v-48ed860d"]]);var M=K;const W=t=>((0,c.dD)("data-v-24e49eec"),t=t(),(0,c.Cn)(),t),$={class:"cart"},R={key:0,class:"product"},A={class:"product__header"},E=["innerHTML"],G=W((()=>(0,c._)("span",null,"全选",-1))),J=W((()=>(0,c._)("div",{class:"product__header__blank"},null,-1))),O={key:0,class:"product__item"},Q=["innerHTML","onClick"],V=["src"],X={class:"product__item__detail"},tt={class:"product__item__title"},et={class:"product__item__price"},st=W((()=>(0,c._)("span",{class:"product__item__yen"},"¥",-1))),ct={class:"product__item__now"},at={class:"product__item__origin"},nt={class:"product__number"},ot=["onClick"],it={key:1,class:"product__number__count"},rt=["onClick"],_t={class:"check"},lt={class:"check__icon"},dt={key:0,class:"check__icon__tag"},ut={class:"check__info"},pt={class:"check__info__price"},mt=W((()=>(0,c._)("div",{class:"check__btn"}," 去结算 ",-1)));function ht(t,e,s,a,n,o){const i=(0,c.up)("router-link");return(0,c.wg)(),(0,c.iD)(c.HY,null,[t.showChart?((0,c.wg)(),(0,c.iD)("div",{key:0,class:"cart__mask",onClick:e[0]||(e[0]=e=>t.showChart=!t.showChart)})):(0,c.kq)("",!0),(0,c._)("div",$,[t.showChart?((0,c.wg)(),(0,c.iD)("div",R,[(0,c._)("div",A,[(0,c._)("div",{class:"product__header__all",onClick:e[1]||(e[1]=e=>t.setCartItemChecked(t.shopId,t.calculations.allChecked))},[(0,c._)("span",{class:"iconfont",innerHTML:t.calculations.allChecked?"":""},null,8,E),G]),J,(0,c._)("div",{class:"product__header__clear",onClick:e[2]||(e[2]=e=>{t.cleanCartProducts(t.shopId),t.showChart=!1})},"清空购物车")]),((0,c.wg)(!0),(0,c.iD)(c.HY,null,(0,c.Ko)(t.calculations.productList,(e=>((0,c.wg)(),(0,c.iD)(c.HY,{key:e._id},[e.count>0?((0,c.wg)(),(0,c.iD)("div",O,[(0,c._)("span",{class:"product__item__checked iconfont",innerHTML:e.check?"":"",onClick:s=>t.changeCartItemChecked(t.shopId,e._id)},null,8,Q),(0,c._)("img",{class:"product__item__img",src:e.imgUrl,alt:""},null,8,V),(0,c._)("div",X,[(0,c._)("div",tt,(0,h.zw)(e.name),1),(0,c._)("div",et,[st,(0,c._)("span",ct,(0,h.zw)(e.price),1),(0,c._)("span",at,"¥"+(0,h.zw)(e.oldPrice),1)])]),(0,c._)("div",nt,[e.count>0?((0,c.wg)(),(0,c.iD)("span",{key:0,class:"iconfont product__number__minus",onClick:s=>t.changeCartItemInfo(t.shopId,e._id,e,-1)},"",8,ot)):(0,c.kq)("",!0),e.count>0?((0,c.wg)(),(0,c.iD)("span",it,(0,h.zw)(e.count||0),1)):(0,c.kq)("",!0),(0,c._)("span",{class:"iconfont product__number__plus",onClick:s=>t.changeCartItemInfo(t.shopId,e._id,e,1)},"",8,rt)])])):(0,c.kq)("",!0)],64)))),128))])):(0,c.kq)("",!0),(0,c._)("div",_t,[(0,c._)("div",lt,[(0,c._)("img",{class:"check__icon__img",src:"http://www.dell-lee.com/imgs/vue3/basket.png",alt:"",onClick:e[3]||(e[3]=e=>t.calculations.sum>0&&(t.showChart=!t.showChart))}),t.calculations.total>0?((0,c.wg)(),(0,c.iD)("div",dt,(0,h.zw)(t.calculations.total),1)):(0,c.kq)("",!0)]),(0,c._)("div",ut,[(0,c.Uk)(" 总计："),(0,c._)("span",pt,"¥"+(0,h.zw)(t.calculations.price),1)]),(0,c.Wm)(i,{to:`/orderConfirmation/${t.shopId}`},{default:(0,c.w5)((()=>[mt])),_:1},8,["to"])])])],64)}var kt=s(220);const gt=()=>{const t=(0,u.yj)(),e=t.params.id,s=(0,d.iH)(!1),{cartList:a,changeCartItemInfo:n,changeCartItemChecked:o,cleanCartProducts:i,setCartItemChecked:r}=S(),_=(0,c.Fl)((()=>{const t=a[e]?.productList;let c=0,n=0,o=0,i=!0;for(const e in t){const s=t[e];c+=s.count,s.check&&(n+=s.count),s.check&&(o+=s.price*s.count),!s.check&&(i=s.check)}return!c&&(s.value=!1),{productList:t,sum:c,total:n,price:o.toFixed(2),allChecked:i}}));return{showChart:s,calculations:_,shopId:e,changeCartItemInfo:n,changeCartItemChecked:o,cleanCartProducts:i,setCartItemChecked:r}};var Ct={name:"Cart",computed:{task(){return kt.task}},setup(){return{...gt()}}};const vt=(0,F.Z)(Ct,[["render",ht],["__scopeId","data-v-24e49eec"]]);var It=vt,wt={name:"Shop",components:{ShopInfo:m.Z,Content:M,Cart:It,Toast:Y.Z},setup(){const t=(0,u.tv)(),e=(0,u.yj)(),s=(0,d.qj)({item:{}}),{toastInfo:c,showToast:a}=(0,Y.S)(),n=async()=>{try{const t=await(0,p.U)(`/api/shop/${e.params.id}`);if(0!==t?.errno)return a(t.desc);s.item=t.data}catch(t){a(t.message)}};n();const o=()=>{t.back()};return{...(0,d.BK)(s),toastInfo:c,handleBackClick:o}}};const ft=(0,F.Z)(wt,[["render",l],["__scopeId","data-v-2d87b51a"]]);var bt=ft}}]);
//# sourceMappingURL=shop.5b652ae6.js.map