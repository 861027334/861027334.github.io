"use strict";(self["webpackChunkjingdong"]=self["webpackChunkjingdong"]||[]).push([[523],{3229:function(t,c,a){a.d(c,{_G:function(){return o},aH:function(){return n},dO:function(){return r},jw:function(){return _},rs:function(){return i}});var e=a(65),s=a(2483);const n=()=>(0,s.yj)().params.id,o=()=>(0,e.oR)().state.cartList,r=()=>o()?.[n()]?.shopName,_=()=>o()?.[n()]?.productList,i=()=>{const t=(0,e.oR)(),c=(c,a,e,s)=>{t.commit("changeCartItemInfo",{shopId:c,productId:a,productInfo:e,num:s})},a=(c,a)=>{t.commit("changeShopName",{shopId:c,shopName:a})},s=(c,a)=>{t.commit("changeCartItemChecked",{shopId:c,productId:a})},n=c=>{t.commit("cleanCartProducts",{shopId:c})},o=(c,a)=>{t.commit("setCartItemChecked",{shopId:c,checked:a})};return{changeShopName:a,changeCartItemInfo:c,changeCartItemChecked:s,cleanCartProducts:n,setCartItemChecked:o}}},6538:function(t,c,a){a.d(c,{Z:function(){return k}});var e=a(3396),s=a(7139);const n={class:"shop"},o=["src"],r={class:"shop__content__title"},_={class:"shop__content__tags"},i={class:"shop__content__tag"},l={class:"shop__content__tag"},d={class:"shop__content__tag"},u={class:"shop__content__highlight"};function p(t,c,a,p,m,h){return(0,e.wg)(),(0,e.iD)("div",n,[(0,e._)("img",{class:"shop__img",src:a.item.imgUrl,alt:""},null,8,o),(0,e._)("div",{class:(0,s.C_)(["shop__content",{"shop__content--bordered":!a.hideBorder}])},[(0,e._)("div",r,(0,s.zw)(a.item.name),1),(0,e._)("div",_,[(0,e._)("span",i,"月售"+(0,s.zw)(a.item.sales),1),(0,e._)("span",l,"起送¥"+(0,s.zw)(a.item.expressLimit),1),(0,e._)("span",d,"基础运费¥"+(0,s.zw)(a.item.expressPrice),1)]),(0,e._)("div",u,(0,s.zw)(a.item.slogan),1)],2)])}var m={name:"ShopInfo",props:["item","hideBorder"]},h=a(89);const C=(0,h.Z)(m,[["render",p],["__scopeId","data-v-820a85e4"]]);var k=C},1368:function(t,c,a){a.r(c),a.d(c,{default:function(){return wt}});var e=a(3396),s=a(9242);const n=t=>((0,e.dD)("data-v-2d87b51a"),t=t(),(0,e.Cn)(),t),o={class:"wrapper"},r={class:"top"},_={class:"top__back"},i=n((()=>(0,e._)("div",{class:"search"},[(0,e._)("span",{class:"iconfont"},""),(0,e._)("input",{type:"text",class:"search__input",placeholder:"请输入商品名称搜索"})],-1)));function l(t,c,a,n,l,d){const u=(0,e.up)("ShopInfo"),p=(0,e.up)("Content"),m=(0,e.up)("Cart"),h=(0,e.up)("Toast");return(0,e.wg)(),(0,e.iD)(e.HY,null,[(0,e._)("div",o,[(0,e._)("div",r,[(0,e._)("div",_,[(0,e._)("span",{class:"iconfont",onClick:c[0]||(c[0]=(...t)=>n.handleBackClick&&n.handleBackClick(...t))},"")]),i]),(0,e.wy)((0,e.Wm)(u,{item:t.item,"hide-border":!0},null,8,["item"]),[[s.F8,t.item.imgUrl]]),(0,e.Wm)(p,{shopName:t.item.name},null,8,["shopName"]),(0,e.Wm)(m)]),n.toastInfo.show?((0,e.wg)(),(0,e.j4)(h,{key:0,message:n.toastInfo.message},null,8,["message"])):(0,e.kq)("",!0)],64)}var d=a(4870),u=a(2483),p=a(6391),m=a(6538),h=a(7139);const C=t=>((0,e.dD)("data-v-8960fc78"),t=t(),(0,e.Cn)(),t),k={class:"content"},g={class:"category"},I=["onClick"],w={class:"product"},v=["src"],f={class:"product__item__detail"},b={class:"product__item__title"},y={class:"product__item__sales"},D={class:"product__item__price"},z=C((()=>(0,e._)("span",{class:"product__item__yen"},"¥",-1))),H={class:"product__item__now"},L={class:"product__item__origin"},P={class:"product__number"},T=["onClick"],q={key:1,class:"product__number__count"},j=["onClick"];function N(t,c,a,s,n,o){const r=(0,e.up)("Toast");return(0,e.wg)(),(0,e.iD)(e.HY,null,[(0,e._)("div",k,[(0,e._)("div",g,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(s.categories,((t,c)=>((0,e.wg)(),(0,e.iD)("div",{class:(0,h.C_)(["category__item",{"category__item--active":s.currentTab===t.tab}]),key:c,onClick:c=>s.currentTab=t.tab},(0,h.zw)(t.name),11,I)))),128))]),(0,e._)("div",w,[((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(t.contentList,(c=>((0,e.wg)(),(0,e.iD)("div",{class:"product__item",key:c._id},[(0,e._)("img",{class:"product__item__img",src:c.imgUrl,alt:""},null,8,v),(0,e._)("div",f,[(0,e._)("div",b,(0,h.zw)(c.name),1),(0,e._)("div",y,"月售"+(0,h.zw)(c.sales)+"件",1),(0,e._)("div",D,[z,(0,e._)("span",H,(0,h.zw)(c.price),1),(0,e._)("span",L,"¥"+(0,h.zw)(c.oldPrice),1)])]),(0,e._)("div",P,[t.getProductCartCount(s.shopId,c._id)>0?((0,e.wg)(),(0,e.iD)("span",{key:0,class:"iconfont product__number__minus",onClick:a=>t.changeCartItemInfo(s.shopId,c._id,c,-1)},"",8,T)):(0,e.kq)("",!0),t.getProductCartCount(s.shopId,c._id)>0?((0,e.wg)(),(0,e.iD)("span",q,(0,h.zw)(t.getProductCartCount(s.shopId,c._id)),1)):(0,e.kq)("",!0),(0,e._)("span",{class:"iconfont product__number__plus",onClick:a=>t.changeCartItemInfo(s.shopId,c._id,c,1)},"",8,j)])])))),128))])]),s.toastInfo.show?((0,e.wg)(),(0,e.j4)(r,{key:0,message:s.toastInfo.message},null,8,["message"])):(0,e.kq)("",!0)],64)}a(7658);var S=a(3229),Y=a(1090);const Z=[{name:"全部商品",tab:"all"},{name:"秒杀",tab:"seckill"},{name:"新鲜水果",tab:"fruit"},{name:"休闲食品",tab:"snacks"},{name:"时令蔬菜",tab:"vegetable"},{name:"肉蛋家禽",tab:"meat"}],B=(t,c)=>{const{changeCartItemInfo:a,changeShopName:s}=(0,S.rs)(),n=(0,S._G)(),o=(t,c)=>n[t]?.productList?.[c]?.count||0;return(0,e.YP)((()=>c.shopName),(()=>{s(t,c.shopName)})),{cartList:n,changeCartItemInfo:a,getProductCartCount:o}};var U={name:"Content",components:{Toast:Y.Z},props:["shopName"],setup(t){const c=(0,S.aH)(),a=(0,d.iH)(Z[0].tab),s=(0,d.qj)({contentList:[]}),{toastInfo:n,showToast:o}=(0,Y.S)(),r=async t=>{try{const a=await(0,p.U)(`/api/shop/${c}s/products`,{tab:t});if(0!==a.errno)return o(a.desc);s.contentList.push(...a.data)}catch(a){o(a.message)}};return r(a.value),(0,e.YP)(a,(()=>{r(a.value)})),{categories:Z,toastInfo:n,currentTab:a,...(0,d.BK)(s),shopId:c,...B(c,t)}}},K=a(89);const x=(0,K.Z)(U,[["render",N],["__scopeId","data-v-8960fc78"]]);var M=x;const F=t=>((0,e.dD)("data-v-84a703e2"),t=t(),(0,e.Cn)(),t),W={class:"cart"},$={key:0,class:"product"},G={class:"product__header"},R=["innerHTML"],O=F((()=>(0,e._)("span",null,"全选",-1))),A=F((()=>(0,e._)("div",{class:"product__header__blank"},null,-1))),E=["innerHTML","onClick"],J=["src"],Q={class:"product__item__detail"},V={class:"product__item__title"},X={class:"product__item__price"},tt=F((()=>(0,e._)("span",{class:"product__item__yen"},"¥",-1))),ct={class:"product__item__now"},at={class:"product__item__origin"},et={class:"product__number"},st=["onClick"],nt={key:1,class:"product__number__count"},ot=["onClick"],rt={class:"check"},_t=F((()=>(0,e._)("img",{class:"check__icon__img",src:"http://www.dell-lee.com/imgs/vue3/basket.png",alt:""},null,-1))),it={key:0,class:"check__icon__tag"},lt={class:"check__info"},dt={class:"check__info__price"},ut=F((()=>(0,e._)("div",{class:"check__btn"}," 去结算 ",-1)));function pt(t,c,a,s,n,o){const r=(0,e.up)("router-link");return(0,e.wg)(),(0,e.iD)(e.HY,null,[t.showChart?((0,e.wg)(),(0,e.iD)("div",{key:0,class:"cart__mask",onClick:c[0]||(c[0]=c=>t.showChart=!t.showChart)})):(0,e.kq)("",!0),(0,e._)("div",W,[t.showChart?((0,e.wg)(),(0,e.iD)("div",$,[(0,e._)("div",G,[(0,e._)("div",{class:"product__header__all",onClick:c[1]||(c[1]=c=>t.setCartItemChecked(t.shopId,t.calculations.allChecked))},[(0,e._)("span",{class:"iconfont",innerHTML:t.calculations.allChecked?"":""},null,8,R),O]),A,(0,e._)("div",{class:"product__header__clear",onClick:c[2]||(c[2]=c=>{t.cleanCartProducts(t.shopId),t.showChart=!1})},"清空购物车")]),((0,e.wg)(!0),(0,e.iD)(e.HY,null,(0,e.Ko)(t.calculations.productList,(c=>((0,e.wg)(),(0,e.iD)("div",{key:c._id,class:"product__item"},[(0,e._)("span",{class:"product__item__checked iconfont",innerHTML:c.check?"":"",onClick:a=>t.changeCartItemChecked(t.shopId,c._id)},null,8,E),(0,e._)("img",{class:"product__item__img",src:c.imgUrl,alt:""},null,8,J),(0,e._)("div",Q,[(0,e._)("div",V,(0,h.zw)(c.name),1),(0,e._)("div",X,[tt,(0,e._)("span",ct,(0,h.zw)(c.price),1),(0,e._)("span",at,"¥"+(0,h.zw)(c.oldPrice),1)])]),(0,e._)("div",et,[c.count?((0,e.wg)(),(0,e.iD)("span",{key:0,class:"iconfont product__number__minus",onClick:a=>t.changeCartItemInfo(t.shopId,c._id,c,-1)},"",8,st)):(0,e.kq)("",!0),c.count>0?((0,e.wg)(),(0,e.iD)("span",nt,(0,h.zw)(c.count||0),1)):(0,e.kq)("",!0),(0,e._)("span",{class:"iconfont product__number__plus",onClick:a=>t.changeCartItemInfo(t.shopId,c._id,c,1)},"",8,ot)])])))),128))])):(0,e.kq)("",!0),(0,e._)("div",rt,[(0,e._)("div",{class:"check__icon",onClick:c[3]||(c[3]=c=>t.calculations.sum>0&&(t.showChart=!t.showChart))},[_t,t.calculations.total>0?((0,e.wg)(),(0,e.iD)("div",it,(0,h.zw)(t.calculations.total),1)):(0,e.kq)("",!0)]),(0,e._)("div",lt,[(0,e.Uk)(" 总计："),(0,e._)("span",dt,"¥"+(0,h.zw)(t.calculations.price),1)]),t.calculations.total?((0,e.wg)(),(0,e.j4)(r,{key:0,to:`/orderConfirmation/${t.shopId}`},{default:(0,e.w5)((()=>[ut])),_:1},8,["to"])):(0,e.kq)("",!0)])])],64)}const mt=()=>{const t=(0,S.aH)(),c=(0,d.iH)(!1),a=(0,e.Fl)((()=>{const t=(0,S.jw)();let a=0,e=0,s=0,n=!0;for(const c in t){const o=t[c];a+=o.count,o.check&&(e+=o.count),o.check&&(s+=o.price*o.count),!o.check&&(n=o.check)}return!a&&(c.value=!1),{productList:t,sum:a,total:e,price:s.toFixed(2),allChecked:n}})),{changeCartItemInfo:s,changeCartItemChecked:n,cleanCartProducts:o,setCartItemChecked:r}=(0,S.rs)();return{shopId:t,showChart:c,calculations:a,changeCartItemInfo:s,changeCartItemChecked:n,cleanCartProducts:o,setCartItemChecked:r}};var ht={name:"Cart",setup(){return{...mt()}}};const Ct=(0,K.Z)(ht,[["render",pt],["__scopeId","data-v-84a703e2"]]);var kt=Ct,gt={name:"Shop",components:{ShopInfo:m.Z,Content:M,Cart:kt,Toast:Y.Z},setup(){const t=(0,u.tv)(),c=(0,u.yj)(),a=(0,d.qj)({item:{}}),{toastInfo:e,showToast:s}=(0,Y.S)(),n=async()=>{try{const t=await(0,p.U)(`/api/shop/${c.params.id}`);if(0!==t?.errno)return s(t.desc);a.item=t.data}catch(t){s(t.message)}};n();const o=()=>{t.back()};return{...(0,d.BK)(a),toastInfo:e,handleBackClick:o}}};const It=(0,K.Z)(gt,[["render",l],["__scopeId","data-v-2d87b51a"]]);var wt=It}}]);
//# sourceMappingURL=shop.1a2040b7.js.map